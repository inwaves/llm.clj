;; Auto-generated test vectors from PyTorch
;; Do not edit manually - regenerate using dev/generate_test_vectors.py

{:operation "encoder"
 :test-case "small"
 :inputs {:inp [[5.0 8.0 5.0 2.0] [5.0 1.0 8.0 0.0]] :wte [[0.8818058967590332 -0.22369535267353058 1.1010370254516602 0.5863944888114929 1.6541743278503418 -1.6188780069351196 0.24177123606204987 0.812629759311676 1.1774626970291138 0.27144479751586914 -0.4949418902397156 0.06297123432159424 -0.2774103879928589 1.0159237384796143 -0.2848714292049408 -0.7639244794845581] [0.8925327658653259 -0.15389034152030945 0.9413242936134338 -0.8618822693824768 0.24809327721595764 1.4765979051589966 1.0286654233932495 0.46900248527526855 1.1588348150253296 1.831298589706421 -0.6524010896682739 -1.3936073780059814 -0.04275958985090256 -0.5101262927055359 -1.2683732509613037 -0.09123595058917999] [0.3301143944263458 -0.5674828290939331 0.15048030018806458 0.006888639181852341 0.125543013215065 0.5812495350837708 -0.3525639474391937 1.0041546821594238 1.396897792816162 1.0158681869506836 -0.8985291719436646 1.6697404384613037 0.38006240129470825 -0.04599429666996002 1.5303666591644287 0.6350771188735962] [-0.502586305141449 0.05429438129067421 -1.2851146459579468 0.4984504282474518 0.2358100712299347 -0.5401199460029602 0.8394067287445068 -1.3783036470413208 -0.37435826659202576 -0.3481312394142151 0.24174121022224426 -2.9170799255371094 -0.535224199295044 0.2035095989704132 1.3836332559585571 -1.111999750137329] [0.5224679112434387 0.529036283493042 0.900898814201355 1.3061256408691406 0.5926225781440735 2.0820353031158447 -1.3377411365509033 1.3454688787460327 0.2138230800628662 -0.750419020652771 1.1052772998809814 0.17536796629428864 1.2429553270339966 1.3850061893463135 -1.2871456146240234 -0.5331303477287292] [-2.3405656814575195 1.9492161273956299 -0.9500623345375061 0.8900399804115295 -1.7388087511062622 0.009320036508142948 1.0458658933639526 -1.1511698961257935 -0.5749574899673462 -0.16928930580615997 0.19514617323875427 0.04394906386733055 0.9618086814880371 0.47913873195648193 -0.32111606001853943 -0.9386268854141235] [-0.806486189365387 1.2270563840866089 -0.79593425989151 -0.1972362995147705 1.3389557600021362 1.438113808631897 0.9386391043663025 -0.1867426037788391 -0.05072581395506859 -1.2369024753570557 0.3796183466911316 -0.5046374797821045 -0.1871480494737625 -0.2641507387161255 0.3516973555088043 0.5182583928108215] [0.6558985710144043 -0.21403750777244568 1.040626049041748 2.1364006996154785 -2.3241937160491943 -0.42507949471473694 -0.01233075000345707 -0.5173496007919312 -2.6846184730529785 -0.22280125319957733 -0.5649455785751343 -0.5335255861282349 -1.2867372035980225 -0.23452040553092957 -1.7298190593719482 -1.197864294052124] [-0.3225400447845459 -1.463065505027771 0.3500504195690155 0.3670451045036316 0.21361376345157623 0.042597707360982895 -1.1287665367126465 0.5619747638702393 1.9417877197265625 0.801103413105011 1.2095937728881836 -2.318732738494873 -0.8790001273155212 0.9858264923095703 -0.46650055050849915 1.6327950954437256] [-1.1278493404388428 -0.9268369078636169 -0.159153550863266 0.6201672554016113 0.48885801434516907 -0.39316654205322266 -0.365738183259964 0.02338038943707943 -0.689359188079834 0.969613790512085 -0.19457721710205078 -0.8629236221313477 -0.229030579328537 -1.086633324623108 1.7195051908493042 0.4796653389930725]] :wpe [[0.07603807002305984 -0.24619147181510925 0.0921083316206932 0.6719661355018616 1.1702936887741089 1.259204387664795 0.7577751278877258 -0.051967401057481766 -0.16522762179374695 1.0046334266662598 -1.1328586339950562 0.8022779226303101 0.44145750999450684 0.03986094892024994 0.7775577306747437 1.9478352069854736] [-0.022460689768195152 0.3099461495876312 1.180710792541504 -0.85258948802948 -0.8434831500053406 -0.06766851246356964 -0.5440508723258972 -0.9720902442932129 -1.11049222946167 1.2321399450302124 0.5204225778579712 0.6304375529289246 0.4722939133644104 0.6920387744903564 -1.0684281587600708 0.5315982699394226] [0.6787406206130981 -1.1236226558685303 0.1774928867816925 1.1191356182098389 0.34111928939819336 -0.9193169474601746 1.069276213645935 0.6440948843955994 1.1904462575912476 -0.5369269847869873 -0.0021755413617938757 1.4122593402862549 1.5622843503952026 0.893375813961029 -0.4482519328594208 -0.3174143135547638] [1.0725452899932861 1.5585485696792603 -0.6054900884628296 0.46665406227111816 1.1509435176849365 -0.07692146301269531 -0.8782024383544922 1.399200677871704 -0.3598065674304962 -0.7032768726348877 2.0706398487091064 0.519182562828064 0.8361333012580872 0.9361018538475037 -0.8474440574645996 0.05063626170158386] [0.6156290769577026 -1.7478947639465332 2.259568452835083 0.510079562664032 -0.48362767696380615 -0.3384895622730255 -0.5280346274375916 -1.4294430017471313 0.8059788942337036 1.4468281269073486 1.6080412864685059 0.03135468810796738 0.8501413464546204 -0.8046347498893738 0.7867631912231445 -1.2102142572402954] [0.37230396270751953 1.4415045976638794 1.0524648427963257 0.09421546757221222 -0.26095515489578247 -0.1946043223142624 0.3044394552707672 -0.8302065134048462 -0.06320087611675262 3.145904541015625 -0.9463685750961304 1.4605696201324463 -0.09827283769845963 0.04733699932694435 -0.7502866387367249 -0.18611538410186768] [0.4609965980052948 -0.25557783246040344 -0.677519679069519 -0.07225502282381058 0.4758673310279846 0.8455625772476196 -0.10112228244543076 1.4705199003219604 1.5463000535964966 -0.20332835614681244 -1.733935832977295 0.23128697276115417 1.0618003606796265 -0.5197917819023132 -0.8756697177886963 -1.5335108041763306] [-0.46605226397514343 -0.22115156054496765 -0.36382821202278137 -1.1947369575500488 -0.4464348256587982 -0.18089190125465393 -1.530752182006836 2.5900490283966064 -0.33003267645835876 -0.24612116813659668 -2.805809259414673 1.1861224174499512 -0.5493519902229309 1.0620582103729248 0.48744523525238037 1.0355467796325684]]}
 :expected {:forward [[[-2.2645275592803955 1.7030246257781982 -0.8579540252685547 1.5620061159133911 -0.5685150623321533 1.268524408340454 1.8036410808563232 -1.2031372785568237 -0.7401851415634155 0.835344135761261 -0.9377124309539795 0.8462269902229309 1.403266191482544 0.5189996957778931 0.4564416706562042 1.00920832157135] [-0.3450007438659668 -1.1531193256378174 1.5307612419128418 -0.4855443835258484 -0.6298694014549255 -0.025070805102586746 -1.6728174686431885 -0.41011548042297363 0.8312954902648926 2.033243417739868 1.7300163507461548 -1.6882951259613037 -0.40670621395111084 1.6778652667999268 -1.5349286794662476 2.164393424987793] [-1.6618250608444214 0.8255934715270996 -0.7725694179534912 2.0091755390167236 -1.3976894617080688 -0.9099969267845154 2.1151421070098877 -0.5070750117301941 0.6154887676239014 -0.7062162756919861 0.1929706335067749 1.456208348274231 2.5240931510925293 1.3725144863128662 -0.7693679928779602 -1.256041169166565] [1.4026596546173096 0.9910657405853271 -0.455009788274765 0.4735426902770996 1.2764865159988403 0.5043280720710754 -1.2307664155960083 2.403355360031128 1.0370912551879883 0.3125913143157959 1.172110676765442 2.188922882080078 1.2161957025527954 0.8901075720787048 0.6829226016998291 0.6857134103775024]] [[-2.2645275592803955 1.7030246257781982 -0.8579540252685547 1.5620061159133911 -0.5685150623321533 1.268524408340454 1.8036410808563232 -1.2031372785568237 -0.7401851415634155 0.835344135761261 -0.9377124309539795 0.8462269902229309 1.403266191482544 0.5189996957778931 0.4564416706562042 1.00920832157135] [0.870072066783905 0.15605580806732178 2.122035026550293 -1.7144718170166016 -0.5953898429870605 1.4089293479919434 0.4846145510673523 -0.5030877590179443 0.04834258556365967 3.0634384155273438 -0.13197851181030273 -0.7631698250770569 0.42953431606292725 0.18191248178482056 -2.336801528930664 0.4403623342514038] [0.35620057582855225 -2.5866880416870117 0.527543306350708 1.4861807823181152 0.5547330379486084 -0.8767192363739014 -0.059490323066711426 1.2060697078704834 3.1322340965270996 0.2641764283180237 1.2074182033538818 -0.9064733982086182 0.6832842230796814 1.8792023658752441 -0.9147524833679199 1.3153808116912842] [1.9543511867523193 1.334853172302246 0.49554693698883057 1.0530486106872559 2.8051178455352783 -1.695799469947815 -0.6364312171936035 2.2118303775787354 0.8176561594009399 -0.43183207511901855 1.575697898864746 0.5821537971496582 0.5587229132652283 1.9520256519317627 -1.1323155164718628 -0.7132881879806519]]] :dwte [[1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0] [1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0] [1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]] :dwpe [[2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0] [2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0] [2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0] [2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0] [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]]}}
